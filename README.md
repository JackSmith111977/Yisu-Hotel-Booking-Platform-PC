# 酒店预订平台 (Hotel Booking Platform)

这是一个基于 Next.js 16 的酒店预订管理平台，包含管理员后台和商户前台功能。

## 技术栈

- **前端框架**: Next.js 16 (App Router)
- **UI组件库**: Arco Design (字节跳动的企业级UI库)
- **状态管理**: Zustand (轻量级状态管理)
- **数据获取**: SWR (React Hooks for data fetching)
- **数据库**: Supabase (PostgreSQL后端即服务)
- **样式**: Tailwind CSS v4
- **开发工具**: TypeScript, ESLint, Prettier

## 快速开始

首先，运行开发服务器：

```bash
npm run dev
# 或者
yarn dev
# 或者
pnpm dev
# 或者
bun dev
```

在浏览器中打开 [http://localhost:3000](http://localhost:3000) 查看结果。

## 项目结构

```
src/
├── actions/          # 服务端操作 (Server Actions)
├── app/             # Next.js App Router页面
│   ├── admin/       # 管理员后台
│   │   ├── audit/   # 审核管理
│   │   └── online/  # 上线管理
│   ├── hotel/       # 商户酒店管理
│   ├── login/       # 登录页面
│   └── register/    # 注册页面
├── components/      # React组件
│   ├── admin/       # 管理员组件
│   ├── auth/        # 认证组件
│   ├── hotel/       # 酒店相关组件
│   └── global/      # 全局组件
├── lib/            # 工具库和配置
├── mocks/          # 模拟数据
├── store/          # Zustand状态存储
└── types/          # TypeScript类型定义
```

## 数据库结构

### Supabase 配置

项目使用 Supabase 作为后端数据库服务。Supabase 配置位于 `src/lib/supabase.ts` 和 `src/lib/supabase_admin.ts`。

### Hotels 表结构

```sql
CREATE TABLE public.hotels (
  -- 主键和标识
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  
  -- 酒店基本信息
  name_zh TEXT NULL,                    -- 酒店中文名称
  name_en TEXT NULL,                    -- 酒店英文名称
  address TEXT NULL DEFAULT ''::text,   -- 酒店地址
  star_rating SMALLINT NULL,            -- 酒店星级 (1-5)
  opening_date DATE NULL,               -- 开业日期
  contact_phone TEXT NULL,              -- 联系电话
  
  -- 图片信息
  image TEXT NULL,                      -- 封面图片URL
  album TEXT[] NULL,                    -- 相册图片URL数组
  
  -- 状态和管理信息
  status TEXT NOT NULL,                 -- 审核状态: pending, approved, rejected, offline
  merchant_id TEXT NULL,                -- 商户ID
  updated_at TIMESTAMP WITH TIME ZONE NULL DEFAULT NOW(), -- 更新时间
  rejected_reason TEXT NULL,            -- 拒绝理由
  
  -- 地区信息
  region TEXT NULL,                     -- 地区信息 (JSON格式)
  
  -- 约束
  CONSTRAINT hotels_pkey PRIMARY KEY (id),
  CONSTRAINT hotels_name_en_key UNIQUE (name_en),
  CONSTRAINT hotels_name_zh_key UNIQUE (name_zh)
) TABLESPACE pg_default;
```

### 字段映射说明

| 数据库字段 | TypeScript 类型 | 说明 |
|-----------|----------------|------|
| `id` | `string` | 酒店ID (bigint 转换为 string) |
| `name_zh` | `string` | 酒店中文名称 |
| `name_en` | `string` | 酒店英文名称 |
| `address` | `string` | 酒店地址 (与 region 合并) |
| `star_rating` | `number` | 酒店星级 |
| `opening_date` | `string` | 开业日期 |
| `contact_phone` | `string` | 联系电话 |
| `image` | `string` | 封面图片URL |
| `album` | `string[]` | 相册图片数组 |
| `status` | `"pending" \| "approved" \| "rejected" \| "offline"` | 审核状态 |
| `merchant_id` | `string` | 商户ID |
| `updated_at` | `string` | 更新时间 (ISO格式) |
| `rejected_reason` | `string \| undefined` | 拒绝理由 |
| `region` | `string` | 地区信息 (JSON字符串) |

### 状态说明

- **pending**: 待审核 - 商户已提交，等待管理员审核
- **approved**: 已通过 - 审核通过，已上线
- **rejected**: 已拒绝 - 审核未通过
- **offline**: 已下线 - 管理员手动下线

## 核心功能

1. **用户认证系统**: 登录/注册功能
2. **管理员后台**:
   - 酒店审核管理 (待审核、已通过、已拒绝)
   - 酒店上线/下线管理
   - 搜索和筛选功能
3. **商户前台**:
   - 酒店信息管理
   - 酒店信息提交和编辑

## 开发指南

### 环境变量

项目使用两个 Supabase 客户端配置：

1. **公共客户端** (`src/lib/supabase.ts`) - 用于前端公开操作
2. **管理端客户端** (`src/lib/supabase_admin.ts`) - 用于服务端管理操作

创建 `.env` 文件并配置 Supabase 连接信息：

```env
# Supabase 配置
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
```

**安全注意事项**：
- `SUPABASE_SERVICE_ROLE_KEY` 具有管理员权限，应妥善保管
- 不要将包含真实密钥的文件提交到版本控制
- 建议使用 `.env.local` 或 `.env.development` 文件存储本地开发配置
- 生产环境应使用环境变量或安全的密钥管理服务

### 代码规范

- 使用 TypeScript 进行类型检查
- 遵循 ESLint 和 Prettier 代码规范
- 组件使用函数式组件和 React Hooks
- 状态管理使用 Zustand

## 部署

### Vercel 部署

最简单的部署方式是使用 [Vercel 平台](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme)。

### 其他部署方式

查看 [Next.js 部署文档](https://nextjs.org/docs/app/building-your-application/deploying) 了解更多详情。
